{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "61d1e9f0_e8515829",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 14,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2024-04-09T15:30:37Z",
      "side": 1,
      "message": "“buildkite agent“, right?",
      "range": {
        "startLine": 14,
        "startChar": 54,
        "endLine": 14,
        "endChar": 58
      },
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a8add773_8178acbd",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 14,
      "author": {
        "id": 1000038
      },
      "writtenOn": "2024-04-10T08:05:07Z",
      "side": 1,
      "message": "Restricting by parent agent would work, but practically the agents could differ as far as extra step has access to the build output of the parent step. More than that, it\u0027s probably fine and desirable to run extra steps in parallel.\n\nThis problem is relevant if we decide to scale the CI with multiple build servers (as we\u0027re trying here in Resoptima). With current nix implementation we end up with multiple isolated nix stores so extra steps can\u0027t be used in the way how they are now.\n\nFrom Buildkite documentation I can see that it\u0027s possible abuse agent meta-data (https://buildkite.com/docs/agent/v3/cli-meta-data) to store unique name tags and then fetch them in runtime. But there\u0027s no easy way to inherit parent\u0027s agent out of the box.",
      "parentUuid": "61d1e9f0_e8515829",
      "range": {
        "startLine": 14,
        "startChar": 54,
        "endLine": 14,
        "endChar": 58
      },
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb2a7cfe_89a1adb4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 14,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2024-11-04T11:40:03Z",
      "side": 1,
      "message": "So I guess the problem you are trying to solve is to prevent the builder having to fetch the build output from cache/another machine in order to run the extraStep?",
      "parentUuid": "a8add773_8178acbd",
      "range": {
        "startLine": 14,
        "startChar": 54,
        "endLine": 14,
        "endChar": 58
      },
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c30d3620_3cdf8ecb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2024-04-09T15:30:37Z",
      "side": 1,
      "message": "It would be nicer if we could force the extraSteps to use the same agent instead somehow?",
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4eede4bf_44aee4b7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000038
      },
      "writtenOn": "2024-04-10T08:05:07Z",
      "side": 1,
      "message": "Replied in the comment below",
      "parentUuid": "c30d3620_3cdf8ecb",
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c56e1d96_a62c755c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2024-11-04T11:39:15Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "4eede4bf_44aee4b7",
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1591c892_6f0cb2ed",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2024-11-04T11:39:15Z",
      "side": 1,
      "message": "Okay, I guess the dilemma is sort of this:\n\n- Adding a new `postBuild` thing is a bit weird and confusing – what the hell is this additional thing?\n- An alternative would be to add a new flag to `extraSteps` like `runInBuildStep` so that `extraSteps` marked like that would be executed in the same manner as `postBuild` is here (in lexical order or whatever). This has the problem that it makes the `extraSteps` logic even more confusing and complex…\n\nWhat do you think?\n\n(I sometimes feel like we should redesign //nix/buildkite from scratch and figure out a whole new paradigm to integrate the CD features we added later in a neater and simpler fashion…)",
      "revId": "632c48e83071d5e783e12d19309b0b999c09ed76",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}