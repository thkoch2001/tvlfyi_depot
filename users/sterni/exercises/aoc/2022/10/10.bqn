âŸ¨SplitOn,ReadDecâŸ© â† â€¢Import "../../lib.bqn"
# Instead of implementing the VM described in the problem, translate the
# program to instructions with equivalent timing for a similar VM that
# only needs 1 cycle for every instruction.
is â† âˆ¾{"noop": <"noop"; ğ•©: (<"noop")âˆ¾<ReadDecâŒ¾(1âŠ¸âŠ‘) (<' ') SplitOn ğ•©}Â¨ â€¢FLines "input"

Op â† {x ğ•Š "noop": x;x ğ•Š "addx"â€¿i: x+i}
Draw â† {ğ•Š câ€¿xâ€¿pic: picâˆ¨(â†•240)((c-1)âŠ¸=âˆ˜âŠ£âˆ§âˆŠ)(âŒŠâŒ¾(Ã·âŸœ40)c)+Â¯1+x+â†•3}
_vm â† {
  is _self s: (âŠ‘s)â‰¥â‰ is? s;
  is _self prevâ€¿sumâ€¿xâ€¿pic:
  cycle â† prev+1
  is _self âŸ¨
    cycle,
    sum+xÃ—cycleÃ—âŠ‘cycleâˆŠ20â€¿60â€¿100â€¿140â€¿180â€¿220,
    x Op (Â¯1+cycle)âŠ‘is,
    Draw cycleâ€¿xâ€¿pic
  âŸ©
}

Â·â€¿sumâ€¿Â·â€¿pic â† is _vm 1â€¿0â€¿1â€¿(240â¥Š0)

â€¢Out "day10.1: "âˆ¾â€¢Fmt sum
â€¢Out "day10.2:"
â€¢Show ".#" âŠËœ âˆ˜â€¿40â¥Špic
