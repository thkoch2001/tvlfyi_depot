âŸ¨ImportBqnLibs, IsAsciiNum, ReadDecâŸ© â† â€¢Import "../../lib.bqn"
âŸ¨ReplaceAll, SplitâŸ© â† ImportBqnLibs "strings.bqn"

i â† ": "âŠ¸SplitÂ¨ â€¢FLines "input"
ReplaceInts â† {
  ğ•Š ğ•©: ğ•ŠÂ´ 2â†‘(Â¬âˆ˜(âˆ§Â´IsAsciiNumâˆ˜âŠ‘âˆ˜âŒ½)Â¨âŠ”âŠ¢) ğ•©;
  # TODO: Efficient replace on tokens
  is ğ•Š es: (((â€¢FmtâŸ(0âŠ¸â‰ â€¢Type))Â¨âŒ¾(1âŠ¸âŠ‘) <Ë˜â‰>is)âŠ¸ReplaceAllâŒ¾(1âŠ¸âŠ‘))Â¨ es
}

c â† 0
CanEval â† (IsAsciiNumâˆ¨âˆŠâŸœ"+-/* ")
Eval â† {
  aâ€¿sâ€¿b â† " " Split ğ•©
  f â† âŠ‘+â€¿-â€¿Ã—â€¿Ã·âŠËœ"+-*/"âŠs
  a Fâ—‹ReadDec b
}
EvalExprs â† {
  pâ€¿e â† 2â†‘((âˆ§Â´CanEvalâˆ˜âŠ‘âˆ˜âŒ½)Â¨âŠ”âŠ¢) ğ•©
  ev â† (EvalâŒ¾(âŠ‘âŒ½))Â¨ e
  c +â†©1
  (âŠ‘(âŠ‘Â¨ev)âˆŠËœ<"root")â—¶âŸ¨EvalExprsâˆ˜(ReplaceIntsâŸœp),1âŠ¸âŠ‘âŠ‘âŸ© ev
}

â€¢Show EvalExprs ReplaceInts i
