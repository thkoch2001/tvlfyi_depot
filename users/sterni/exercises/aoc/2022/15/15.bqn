lib ‚Üê ‚Ä¢Import "../../lib.bqn"

F ‚Üê ¬¨‚àò('-'‚ä∏=‚à®lib.IsAsciiNum)
i ‚Üê ‚åΩÀòÀò‚àò‚Äø2‚Äø2‚•älib.ReadDec¬®>(0‚ä∏<‚üú‚â†¬®/‚ä¢)‚àò((F ¬Ø1Àô‚çü‚ä£¬®(+`F))‚äî‚ä¢)¬® ‚Ä¢FLines "input"

ssp ‚Üê 4000000

sds ‚Üê (‚äèÀò‚àæÀò(+¬¥Àò(|(-Àù))Àò)) i

# _fix is needed to deal with e.g. ‚ü®0‚Äø15, 5‚Äø8, 12‚Äø23‚ü©
MergeRanges ‚Üê ((‚äë‚àæ‚äë‚àò‚åΩ)‚àò‚àß‚àò‚àæ)¬®‚àò(+`‚àò((<‚àû‚Äø‚àû)‚ä∏¬ª{<¬¥1‚Äø2‚äèùï®‚àæùï©}¬®‚ä¢)‚äî‚ä¢) lib._fix

Range ‚Üê {cky ùïä y‚Äøx‚Äød: x+¬Ø1‚Äø1√ód-|cky-y}
RangesY ‚Üê {<Àò‚àßùï©(‚ä£RangeÀò({cky ùïä y‚Äø¬∑‚Äød: d‚â•|y-cky}Àò/‚ä¢))sds}
OutRangeY ‚Üê {(1<‚â†)‚ó∂‚ü®0Àô,ùï©‚ä∏+‚àò(ssp‚ä∏√ó‚üú(+‚üú1))‚àò(1‚ä∏‚äë)‚àò‚àæ‚ü© MergeRanges ssp‚åä0‚åàRangesY ùï©}

‚Ä¢Out "day15.1: "‚àæ‚Ä¢Fmt +¬¥-Àú¬¥¬®MergeRanges RangesY 2√∑Àússp
‚Ä¢Out "day15.2: "‚àæ‚Ä¢Fmt +¬¥OutRangeY¬®‚Üïssp
