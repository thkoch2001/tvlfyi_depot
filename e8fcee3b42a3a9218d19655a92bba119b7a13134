{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a8069581_8bcafa88",
        "filename": "tvix/eval/README.md",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2022-09-11T13:10:56Z",
      "side": 1,
      "message": "This doesn\u0027t seem to work currently:\n\n```\n[mg] building target //tvix/eval\nbuilding \u0027/nix/store/6r45n5w8pxq9mi0dby740bpzyqmljmd6-source.drv\u0027...\n\ntrying https://github.com/hercules-ci/gitignore/archive/f9e996052b5af4032fe6150bba4a6fe4f7b9d698.tar.gz\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n100 13438    0 13438    0     0  17966      0 --:--:-- --:--:-- --:--:-- 17966\nunpacking source archive /build/f9e996052b5af4032fe6150bba4a6fe4f7b9d698.tar.gz\nbuilding \u0027/nix/store/hqrf430pj0v6acl9wa2srnkdgv7x59zz-sparse-eval.drv\u0027 on \u0027ssh://root@box.flokli.de\u0027...\ncopying 2 paths...\ncopying path \u0027/nix/store/a152apj5gy0jh7yfld8vvz266n4b9krq-Cargo.toml\u0027 to \u0027ssh://root@box.flokli.de\u0027...\ncopying path \u0027/nix/store/qwkma9jzf1mzlnmzr40anmc0nizbwa30-Cargo.lock\u0027 to \u0027ssh://root@box.flokli.de\u0027...\ncopying 1 paths...\ncopying path \u0027/nix/store/8yn5apvsxjy9wzwxf84n4z2m9rjzv3n7-sparse-eval\u0027 from \u0027ssh://root@box.flokli.de\u0027...\nDownloading benches/all-packages.nix (803 KB)\nError downloading object: benches/all-packages.nix (935f239): Smudge error: Error downloading benches/all-packages.nix (935f239a576caa554e546072772039f6efcbde2f2e6568733b8857fe476c5604): batch request: missing protocol: \"\"\n\nErrors logged to \u0027/home/flokli/.cache/nix/gitv3/1qzfb517dymd9fbs5nznalj8803yx2mzy4wzjxfr1wqfc3nj00q2/lfs/logs/20220911T150751.495772919.log\u0027.\nUse `git lfs logs last` to view the log.\nerror: external filter \u0027git-lfs filter-process\u0027 failed\nfatal: benches/all-packages.nix: smudge filter lfs failed\nerror: failed to extract archive (Source threw exception: error: program \u0027git\u0027 failed with exit code 128)\n\n       … while fetching the input \u0027git+https://github.com/nix-community/rnix-parser.git?rev\u003d97b438e34be5211a4b48aeed9cc3ded489b4d6da\u0027\n\n       … while evaluating the attribute \u0027checkout\u0027 of the derivation \u0027rnix\u0027\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/pkgs/stdenv/generic/make-derivation.nix:270:7:\n\n          269|     // (lib.optionalAttrs (attrs ? name || (attrs ? pname \u0026\u0026 attrs ? version)) {\n          270|       name \u003d\n             |       ^\n          271|         let\n\n       … while evaluating the attribute \u0027paths\u0027 of the derivation \u0027dependencies\u0027\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/pkgs/stdenv/generic/make-derivation.nix:270:7:\n\n          269|     // (lib.optionalAttrs (attrs ? name || (attrs ? pname \u0026\u0026 attrs ? version)) {\n          270|       name \u003d\n             |       ^\n          271|         let\n\n       … while evaluating \u0027outputVal\u0027\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:41:15:\n\n           40|\n           41|   outputVal \u003d v:\n             |               ^\n           42|     let\n\n       … from call site\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:39:9:\n\n           38|           \"{ ${valsStr} }\" else\n           39|         outputVal v;\n             |         ^\n           40|\n\n       … while evaluating \u0027outputValInner\u0027\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:28:20:\n\n           27|\n           28|   outputValInner \u003d v:\n             |                    ^\n           29|     let\n\n       … from call site\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:69:42:\n\n           68|           vals \u003d mapAttrsToList\n           69|             (k\u0027: v\u0027: \"${quoteKey k\u0027} \u003d ${outputValInner v\u0027}\") v;\n             |                                          ^\n           70|           valsStr \u003d concatStringsSep \", \" vals;\n\n       … while evaluating anonymous lambda\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:69:18:\n\n           68|           vals \u003d mapAttrsToList\n           69|             (k\u0027: v\u0027: \"${quoteKey k\u0027} \u003d ${outputValInner v\u0027}\") v;\n             |                  ^\n           70|           valsStr \u003d concatStringsSep \", \" vals;\n\n       … from call site\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/lib/attrsets.nix:356:16:\n\n          355|   mapAttrsToList \u003d f: attrs:\n          356|     map (name: f name attrs.${name}) (attrNames attrs);\n             |                ^\n          357|\n\n       … while evaluating anonymous lambda\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/lib/attrsets.nix:356:10:\n\n          355|   mapAttrsToList \u003d f: attrs:\n          356|     map (name: f name attrs.${name}) (attrNames attrs);\n             |          ^\n          357|\n\n       … from call site\n\n       … while evaluating anonymous lambda\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:133:10:\n\n          132|       concatMapStringsSep \"\\n\"\n          133|         (kv: concatStringsSep \"\\n\" (outputKeyVal kv.k kv.v))\n             |          ^\n          134|         (\n\n       … from call site\n\n       … while evaluating \u0027concatMapStringsSep\u0027\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/lib/strings.nix:111:5:\n\n          110|     # List of input strings\n          111|     list: concatStringsSep sep (map f list);\n             |     ^\n          112|\n\n       … from call site\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:132:7:\n\n          131|     in\n          132|       concatMapStringsSep \"\\n\"\n             |       ^\n          133|         (kv: concatStringsSep \"\\n\" (outputKeyVal kv.k kv.v))\n\n       … while evaluating \u0027toTOML\u0027\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/builtins/to-toml.nix:119:12:\n\n          118|\n          119|   toTOML \u003d attrs:\n             |            ^\n          120|     assert (typeOf attrs \u003d\u003d \"set\");\n\n       … from call site\n\n       at /nix/store/jw6ffjrxc08dqbnkmds0hpy0js3i8cn9-naersk-src/build.nix:84:19:\n\n           83|     # and git dependencies.\n           84|     cargoconfig \u003d builtinz.toTOML {\n             |                   ^\n           85|       source \u003d {\n\n       … while evaluating the attribute \u0027cargoconfig\u0027 of the derivation \u0027tvix-eval-deps-0.1.0\u0027\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/pkgs/stdenv/generic/make-derivation.nix:270:7:\n\n          269|     // (lib.optionalAttrs (attrs ? name || (attrs ? pname \u0026\u0026 attrs ? version)) {\n          270|       name \u003d\n             |       ^\n          271|         let\n\n       … while evaluating the attribute \u0027builtDependencies\u0027 of the derivation \u0027tvix-eval-0.1.0\u0027\n\n       at /nix/store/20damslrwz2y68vw1f1nal3va8qj2ry6-nixpkgs-src/pkgs/stdenv/generic/make-derivation.nix:270:7:\n\n          269|     // (lib.optionalAttrs (attrs ? name || (attrs ? pname \u0026\u0026 attrs ? version)) {\n          270|       name \u003d\n             |       ^\n```",
      "revId": "e8fcee3b42a3a9218d19655a92bba119b7a13134",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0ce8d776_d4cdc6d0",
        "filename": "tvix/eval/README.md",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2022-09-11T13:28:25Z",
      "side": 1,
      "message": "This also happens without using the remote builder. It looks like naersk has problems with the git+https://github.com/nix-community/rnix-parser.git?rev\u003d97b438e34be5211a4b48aeed9cc3ded489b4d6da URL?",
      "parentUuid": "a8069581_8bcafa88",
      "revId": "e8fcee3b42a3a9218d19655a92bba119b7a13134",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be6f3c71_5b8a8bd3",
        "filename": "tvix/eval/README.md",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2022-09-11T14:29:33Z",
      "side": 1,
      "message": "This might be related to https://github.com/NixOS/nix/issues/5313, but confusingly, even when temporarily using nix-build 2.3 to build, it still fails with the same errors.",
      "parentUuid": "0ce8d776_d4cdc6d0",
      "revId": "e8fcee3b42a3a9218d19655a92bba119b7a13134",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf998e16_09471aa9",
        "filename": "tvix/eval/README.md",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2022-09-11T14:57:40Z",
      "side": 1,
      "message": "Based on what you wrote on IRC,\n\n\u003e even when temporarily using nix-build 2.3 \n\nI think you didn\u0027t replace the daemon. But yeah, this seems like it is related to post-2.3 bugs, which TVL does not support. I can update the README to note this, and if somebody finds a low-impact workaround they can submit a CL for it.",
      "parentUuid": "be6f3c71_5b8a8bd3",
      "revId": "e8fcee3b42a3a9218d19655a92bba119b7a13134",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}