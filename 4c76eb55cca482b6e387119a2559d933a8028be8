{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "33f74f4f_13b4a2c0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-06-13T19:55:07Z",
      "side": 1,
      "message": "It\u0027s a bit odd this doesn\u0027t expose the bug that cl/11812 should fix?",
      "revId": "4c76eb55cca482b6e387119a2559d933a8028be8",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9cddf955_a8f723e2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-06-13T21:06:10Z",
      "side": 1,
      "message": "chatted with @me@griff.name about this - this is because `DecompressedReaderInner` wraps the  `WithPreexistingBuffer` always with a `BufReader` that can hold much more bytes.\n\nWe should get rid of that (possible double) buffer, and also implement `AsyncBufRead` if the underlying reader supports it.",
      "parentUuid": "33f74f4f_13b4a2c0",
      "revId": "4c76eb55cca482b6e387119a2559d933a8028be8",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be5b12b2_19143d76",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000082
      },
      "writtenOn": "2024-07-23T14:12:10Z",
      "side": 1,
      "message": "There isn\u0027t any double buffering as such you just can\u0027t trigger the situation fixed in cl/11812 here because the amount of bytes read to detect compression and put into WithPreexistingBuffer is smaller than the buffer in BufReader. The first thing BufReader does is fill its buffer which is a larger read than buffer in WithPreexistingBuffer and the bug is for reads smaller than the buffer in WithPreexistingBuffer.\n\nYou also wont be able to test it by doing a small read on the decompressed stream as that is independant of compressed input stream.\n\nIf you want to test for the bug you need to test with WithPreexistingBuffer directly.\n\nWe also can\u0027t implement `AsyncBufRead` for `DecompressedReader` since non of the underlying decoders implement Â´AsyncBufRead`",
      "parentUuid": "9cddf955_a8f723e2",
      "revId": "4c76eb55cca482b6e387119a2559d933a8028be8",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e901c677_702b703f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-07-23T14:42:38Z",
      "side": 1,
      "message": "Ok",
      "parentUuid": "be5b12b2_19143d76",
      "revId": "4c76eb55cca482b6e387119a2559d933a8028be8",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}