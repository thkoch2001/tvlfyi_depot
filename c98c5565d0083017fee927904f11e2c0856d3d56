{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "797d4ada_4291c3fe",
        "filename": "tvix/eval/src/vm.rs",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2022-09-09T13:13:59Z",
      "side": 1,
      "message": "Couldn\u0027t we keep the stack_offset from when the call frame was entered? Overwriting the stuff that frame placed on the stack shouldn\u0027t make any difference, right?",
      "revId": "c98c5565d0083017fee927904f11e2c0856d3d56",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8336d306_41386e56",
        "filename": "tvix/eval/src/vm.rs",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2022-09-09T21:14:31Z",
      "side": 1,
      "message": "I don\u0027t understand what you mean. Overwriting how, by writing into slots through indexes?",
      "parentUuid": "797d4ada_4291c3fe",
      "revId": "c98c5565d0083017fee927904f11e2c0856d3d56",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06148d27_9e1ec187",
        "filename": "tvix/eval/src/vm.rs",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2022-09-09T22:53:06Z",
      "side": 1,
      "message": "Right, that is indeed a problem! I guess we would need to rework how pushing and popping from the stack works for this or split off stack_offset..stack.len() here.\n\nThis is based on the assumption I have that when doing a tail call there may e.g. locals left on the stack that are completely unreachable, but still occupy space (which we\u0027d ideally like to avoid in a tail call).",
      "parentUuid": "8336d306_41386e56",
      "revId": "c98c5565d0083017fee927904f11e2c0856d3d56",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ebddc9d4_1f522f08",
        "filename": "tvix/eval/src/vm.rs",
        "patchSetId": 2
      },
      "lineNbr": 472,
      "author": {
        "id": 1000034
      },
      "writtenOn": "2022-09-09T13:13:59Z",
      "side": 1,
      "message": "Would it be possible to detect if we are tail calling the same closure as we are already in and thus keep the upvalues list as is to avoid this copy?",
      "revId": "c98c5565d0083017fee927904f11e2c0856d3d56",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de2c4943_406a6f1a",
        "filename": "tvix/eval/src/vm.rs",
        "patchSetId": 2
      },
      "lineNbr": 472,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2022-09-09T21:14:06Z",
      "side": 1,
      "message": "Possibly yeah, though we don\u0027t store the Closure directly in the VM, could do it with some metadata. Adding a note.",
      "parentUuid": "ebddc9d4_1f522f08",
      "revId": "c98c5565d0083017fee927904f11e2c0856d3d56",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}