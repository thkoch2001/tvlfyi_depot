{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "395b94cb_9e50c3e9",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T11:25:47Z",
      "side": 1,
      "message": "```\nlet mut buf :[u8; 8];\nconn.read_exact(\u0026mut buf).await?;\n```\n\nThis should be on the stack (and you can reuse it later).",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d66379a_cfd42a82",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2024-03-21T18:48:28Z",
      "side": 1,
      "message": "Nice, better!",
      "parentUuid": "395b94cb_9e50c3e9",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05a8ac8d_3dee354a",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T19:08:48Z",
      "side": 1,
      "message": "But the comment about doing allocation is still there? ðŸ˜•",
      "parentUuid": "6d66379a_cfd42a82",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "694b37f9_e6e46eda",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T22:50:08Z",
      "side": 1,
      "message": "Hmmh, maybe we can also have a skip_bytes\u003cN\u003e function that simply skips the specified number of bytes. it\u0027s a bit nicer than having this long-lived buffer here?",
      "parentUuid": "05a8ac8d_3dee354a",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4bb21a5c_4d91f6a5",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2024-03-22T06:31:09Z",
      "side": 1,
      "message": "Good point, let\u0027s do this.\n\nLet\u0027s keep the function in the daemon for now: that\u0027s the only place where we intend to skip content for now.\n\nWe\u0027ll move this to nix-compat when we\u0027ll move the whole handshake to nix-compat.",
      "parentUuid": "694b37f9_e6e46eda",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a0e2e175_bcc25cff",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2024-03-22T07:01:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4bb21a5c_4d91f6a5",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00b560a3_f5acaff1",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T11:25:47Z",
      "side": 1,
      "message": "Is there still some clients out in the wild using any of this? If we know what it means, I\u0027d opt to just keep these around in some enum fields, users can still ignore it.",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0a6eea0_f0980b65",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2024-03-21T18:34:25Z",
      "side": 1,
      "message": "The Nix daemon itself ignore those, the semantics are not clear, at least not without a fair bit of spelunking. This one (cpu affinity), is the most \"recently\" deprecated one, and it dates from 2019, 5 years ago (time flies!).\n\nhttps://github.com/NixOS/nix/commit/9747ea84b43c75f719d719673b9d0a7cb50d34e5\n\nI\u0027d be in favor of leaving this as it is until we end up in a situation where we need those.",
      "parentUuid": "00b560a3_f5acaff1",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ecc7258_d3240bf0",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T19:08:48Z",
      "side": 1,
      "message": "Ok. Let\u0027s keep in mind to at least keep the comment around to say what this once was when refactoring this out into nix-compat.",
      "parentUuid": "b0a6eea0_f0980b65",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd6a2e95_aa0fd747",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 112,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2024-03-21T11:25:47Z",
      "side": 1,
      "message": "In here (users/picnois) you can to do whatever you want :-)\n\nIn the bigger picture, assuming some of the protocol interaction gets moved to nix-compat, we probably want to have some handshake function that takes what to send here as an argument, so the user can specify the version string.",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "267dafcb_c4a43931",
        "filename": "users/picnoir/tvix-daemon/src/main.rs",
        "patchSetId": 1
      },
      "lineNbr": 112,
      "author": {
        "id": 1000096
      },
      "writtenOn": "2024-03-21T18:48:28Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "fd6a2e95_aa0fd747",
      "revId": "86af82b7f2cf99bd7370b586422502467393c7f9",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}