{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "34f918a7_c8a6ddcf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 14
      },
      "lineNbr": 0,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "I have some nitpicks on the usage of wrapping arith rather than saturating in this context",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2120e817_58138504",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 19,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "cursor",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "388ce3ec_c33ba205",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 19,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T10:50:22Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2120e817_58138504",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2de81800_6ddb0496",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 39,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "What are the considerations from the Tvix Store wrt to `usize` differences on different platforms and potential overflows/underflows when casting/doing stuff with u64 or less?",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f242e91_b449e219",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 39,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T10:49:51Z",
      "side": 1,
      "message": "So, this function is using usize in some places and u64 in others, because `std::io::Read::take()` accepts a u64 as limit type, but `std::io::Read::read` (which this is a helper function for) can only read usize bytes.\n\nI tried to make this cleaner in some more comments, PTAL.",
      "parentUuid": "2de81800_6ddb0496",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fb561b33_13bc3f45",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 39,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T20:08:11Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4f242e91_b449e219",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "284a4ebf_9245c16f",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 46,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "nit: no return, use `else` for more idiomatic Rust?",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e27c6397_2de7cbd5",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 46,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T10:49:51Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "284a4ebf_9245c16f",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7eab766b_25c598aa",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 53,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "This is not necessarily safe on bad platformsâ„¢",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "385f3923_b0b7a1e8",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 53,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T10:49:51Z",
      "side": 1,
      "message": "See the comment above. n \u003e m can\u0027t happen, and m is usize.",
      "parentUuid": "7eab766b_25c598aa",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f005226f_3ed7db78",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 53,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T20:08:11Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "385f3923_b0b7a1e8",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae522757_fa3739c6",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 72,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "shouldn\u0027t this be using saturating addition to prevent overflows?",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f33ddb55_e9ad8173",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 72,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T10:49:51Z",
      "side": 1,
      "message": "We only read up to buf.len() bytes, which is usize.",
      "parentUuid": "ae522757_fa3739c6",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "63939573_a8931560",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 72,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T20:08:11Z",
      "side": 1,
      "message": "Okay I\u0027m convinced",
      "parentUuid": "f33ddb55_e9ad8173",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41dc36a2_c4293ee9",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 94,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-05T13:56:24Z",
      "side": 1,
      "message": "can\u0027t chunk_data be very big?",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11d68dad_ae132b66",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 94,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-05T15:01:19Z",
      "side": 1,
      "message": "chunks are meant to be small enough to be kept in memory - which is why the chunkservice interface does pass Vec\u003cu8\u003e around. but blobs can get very big.\n\nThe exact values still need to be determined, but we initialize the chunker to chunk to pieces in the range of some KB, few MB max.\n\nI need to think about which bit sizes to use here to make this safe.",
      "parentUuid": "41dc36a2_c4293ee9",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6cd1ba00_0e807cfe",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 94,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-06T15:46:55Z",
      "side": 1,
      "message": "Done from my side - explained above and in the comments in the new revisions.",
      "parentUuid": "11d68dad_ae132b66",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "85fa7a3b_2af28640",
        "filename": "tvix/store/src/blobreader.rs",
        "patchSetId": 14
      },
      "lineNbr": 94,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T20:08:11Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "6cd1ba00_0e807cfe",
      "revId": "f243651cc54b4e67af5420d1c89a58f8ae55672e",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}