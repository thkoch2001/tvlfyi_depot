{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f157c991_762a7281",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 25
      },
      "lineNbr": 0,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "I am unable to wrap properly my mind around this cl due to the tree/graph thing",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee7d37b5_e3f12736",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 31,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "why 5? (comment for rationale)",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5b7be8bd_848df0bb",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 31,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-07T22:12:41Z",
      "side": 1,
      "message": "pure dice roll, i want to give this some elasticity for small-ish closures. we might be able to make this bigger, but it needs to be benchmarked.",
      "parentUuid": "ee7d37b5_e3f12736",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e439ca9_5abb18fe",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 31,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T19:38:10Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "5b7be8bd_848df0bb",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3e5ad3b_447d81f3",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 80,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "can we log more information about the details? eg which dir or digest\nit can be a debug! or trace! if you prefer too",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51a47a4a_cf480921",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 80,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-07T22:12:41Z",
      "side": 1,
      "message": "We do, don\u0027t we? it should be inside the span introduced in L63, so the log line (or trace emitted ) should inherit all fields from all parents.",
      "parentUuid": "f3e5ad3b_447d81f3",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b29ec940_3a4edf6b",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 80,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T19:38:10Z",
      "side": 1,
      "message": "Oh you\u0027re definitely right, my badâ€¦",
      "parentUuid": "51a47a4a_cf480921",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "070cc24d_84199124",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 95,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "sad about the O(n) induced by this but no premature optimization I guess",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f0c2a216_ab9339aa",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 95,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-07T22:12:41Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "070cc24d_84199124",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f54dea3c_9998ab4a",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 103,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "I\u0027m not sure what is the supposed interaction of this optimistic update with the consistency check above, the comment is also creating more doubts than clarification :P",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "901d2416_6ef2dcab",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 103,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-07T22:12:41Z",
      "side": 1,
      "message": "This was trying to explain that sent_directory_digests is a bit of a misleading name. We track the digest of the Ok(directory) we\u0027re \"returning\" in L108, which will be sent soon (L115), but at the point of adding it to sent_directory_dgsts it\u0027s not sent out yet. To understand the logic however, calling this sent_directory_dgsts kinda makes sense.\n\nDo you have a better proposal for the variable name or comment?",
      "parentUuid": "f54dea3c_9998ab4a",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b09e18c2_2db2790c",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 103,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-08T19:38:10Z",
      "side": 1,
      "message": "the description you make seems to say that it\u0027s *being* sent, so: `sending_directory_dgsts`?\nI have no strong opinion when you explain it this way, but the comment on the variable sent_directory_dgsts explicitly say this is a list of \"already sent\" directory messages and here the comment say \"not quite in fact\", saying it\u0027s being sent directory msgs is better for the \"not sending twice the same thing\" goal IMHO.",
      "parentUuid": "901d2416_6ef2dcab",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fbcf3adb_dd6c738c",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 186,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "didn\u0027t understand all the comment",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7b77eca7_c97d6d09",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 186,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-10T09:26:14Z",
      "side": 1,
      "message": "We don\u0027t validate the currently received directory refers to at least one child we already received - we only check it doesn\u0027t point to something we didn\u0027t see yet.\n\nSo this could abuse this to send two entirely disconnected graphs.\nI updated the comment and pushed again, let me know if this makes more sense now.",
      "parentUuid": "fbcf3adb_dd6c738c",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "908f4d25_65c7a391",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 208,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "why ? wouldn\u0027t work here?",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01bb038f_8cc9c79a",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 208,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-07T22:12:41Z",
      "side": 1,
      "message": "Ah, that might have been before i had the From trait. good point, will clean up.",
      "parentUuid": "908f4d25_65c7a391",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ad87a79f_b13e40f1",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 208,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-08T15:49:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "01bb038f_8cc9c79a",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0be7c8d1_316cc9ea",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 220,
      "author": {
        "id": 1000073
      },
      "writtenOn": "2023-03-07T21:29:11Z",
      "side": 1,
      "message": "terminology is confusing, is root_digest the digest of the root node of... ? or is it something related to the Merkle tree?",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb71511f_0fda7a9e",
        "filename": "tvix/store/src/proto/grpc_directoryservice_wrapper.rs",
        "patchSetId": 25
      },
      "lineNbr": 220,
      "author": {
        "id": 1000036
      },
      "writtenOn": "2023-03-10T09:26:14Z",
      "side": 1,
      "message": "This service receives a list/stream/closure of directory messages that are connected (from the leaves to the root), and this is pointing to the digest of the last / \"most parent\" / \"root\" directory node. See also my comment at https://cl.tvl.fyi/c/depot/+/8094/comment/fbcf3adb_dd6c738c/.\n\nThe name of the field is coming from the definition of PutDirectoryResponse in https://cs.tvl.fyi/depot/-/blob/tvix/store/protos/rpc_directory.proto. If it\u0027s unintuitive, we should update it in a later commit, and update it here as well.",
      "parentUuid": "0be7c8d1_316cc9ea",
      "revId": "bf898031649c475ab82d491e95904aa85410ca30",
      "serverId": "4fdfa107-4df9-4596-8e0a-1d2bbdd96e36"
    }
  ]
}